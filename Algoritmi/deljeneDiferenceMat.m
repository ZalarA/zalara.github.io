function D=deljeneDiferenceMat(X,Y)  %iscemo interpolacijski polinom p za podatke X=[x1,x2,...,xn], Y=[y1,y2,...,yn]  %funkcija izpise matriko deljenih diferenc D za vektorja X,Y.   %Ce je x1=x2=...=xk, potem so y1,y2,...yk enake p(x1),p'(x1),p^{(2)}(x1),...,p^{(k)}(x1). Podobno za ostale x_i-je.    n=length(X);    %V Xr si zapisemo vse razlicne vrednosti v X, v k pa stevilo ponovitev.    Xr=[];  k=[];    Xr(1)=X(1);  k(1)=1;  tekoci=X(1);    for i=2:n    if X(i)~=tekoci      Xr(length(Xr)+1)=X(i);      tekoci=X(i);      k(length(k)+1)=1;    else      k(length(k))=k(length(k))+1;    end  end       %D je matrika deljenih diferenc        D=zeros(n,n);    %Spremenimo matriko D samo tam, kjer se pojavijo deljene diference, ki pripadajo istim tockam.  for i=1:length(Xr)    stevec=0;    for j=1:i-1      stevec=stevec+k(j);    end    D(stevec+1:stevec+k(i),1:k(i))=deljeneDiferenceEnakeMat(Xr(i),Y(stevec+1:stevec+k(i)));  end  %racunamo preostale stolpce matrike D  for i=2:n    for j=i:n      if X(j)~=X(j-i+1)        D(j,i)=(D(j,i-1)-D(j-1,i-1))/(X(j)-X(j-i+1));      end         end  end    end